<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filtering for IR and Alternative Splicing Events — Run_SpliceWiz_Filters • SpliceWiz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filtering for IR and Alternative Splicing Events — Run_SpliceWiz_Filters"><meta property="og:description" content="These function implements filtering of alternative splicing events,
based on customisable criteria. See ASEFilter for details on how to
construct SpliceWiz filters"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpliceWiz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SW_Cookbook.html">SpliceWiz: the cookbook</a>
    </li>
    <li>
      <a href="../articles/SW_QuickStart.html">SpliceWiz: Quick Start</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexchwong/SpliceWiz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filtering for IR and Alternative Splicing Events</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexchwong/SpliceWiz/blob/HEAD/R/Filters.R" class="external-link"><code>R/Filters.R</code></a></small>
    <div class="hidden name"><code>Run_SpliceWiz_Filters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These function implements filtering of alternative splicing events,
based on customisable criteria. See <a href="ASEFilter-class.html">ASEFilter</a> for details on how to
construct SpliceWiz filters</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getDefaultFilters</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">applyFilters</span><span class="op">(</span><span class="va">se</span>, filters <span class="op">=</span> <span class="fu">getDefaultFilters</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">runFilter</span><span class="op">(</span><span class="va">se</span>, <span class="va">filterObj</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>se</dt>
<dd><p>the <a href="NxtSE-class.html">NxtSE</a> object to filter</p></dd>


<dt>filters</dt>
<dd><p>A vector or list of one or more ASEFilter objects. If left
blank, the SpliceWiz default filters will be used.</p></dd>


<dt>filterObj</dt>
<dd><p>A single <a href="ASEFilter-class.html">ASEFilter</a> object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>For <code>runFilter</code> and <code>applyFilters</code>: a vector of type <code>logical</code>,
representing the rows of NxtSE that should be kept.</p>


<p>For <code>getDefaultFilters</code>: returns a list of default recommended filters
that should be parsed into <code>applyFilters</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>We highly recommend using the default filters, which are as follows:</p><ul><li><p>(1) Depth filter of 20,</p></li>
<li><p>(2) Participation filter requiring 70% coverage in IR events.</p></li>
<li><p>(3) Participation filter requiring 40% coverage in SE, A5SS and A3SS events
(i.e. Included + Excluded isoforms must cover at least 40% of all junction
events across the given region)</p></li>
<li><p>(4) Consistency filter requring log difference of 2 (for skipped exon and
mutually exclusive exon events, each junction must comprise at least 1/(2^2)
= 1/4 of all reads associated with each isoform).
For retained introns, the exon-intron overhangs must not differ by 1/4</p></li>
<li><p>(5) Terminus filter: In alternate first exons, the splice junction must
not be shared with another transcript for which it is not its first
intron. For alternative last exons, the splice junction must not be
shared with another transcript for which it is not its last intron</p></li>
<li><p>(6) ExclusiveMXE filter: For MXE events, the two alternate
casette exons must not overlap in their genomic regions</p></li>
</ul><p>In all data-based filters, we require at least 80% samples (<code>pcTRUE = 80</code>)
to pass this filters from the entire dataset (<code>minCond = -1</code>).</p>
<p>Events with event read depth (reads supporting either included or excluded
isoforms) lower than 5 (<code>minDepth = 5</code>) are not assessed in filter #2, and
in #3 and #4 this threshold is (<code>minDepth = 20</code>).</p>
<p>For an explanation of the various parameters mentioned here, see <a href="ASEFilter-class.html">ASEFilter</a></p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>getDefaultFilters</code>: Returns a vector of recommended default
SpliceWiz filters</p></li>
<li><p><code>applyFilters</code>: Run a vector or list of ASEFilter objects
on a NxtSE object</p></li>
<li><p><code>runFilter</code>: Run a single filter on a NxtSE object</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="ASEFilter-class.html">ASEFilter</a> for details describing how to create and assign settings
to ASEFilter objects.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># see ?makeSE on example code of how this object was generated</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="example-SpliceWiz-data.html">SpliceWiz_example_NxtSE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the list of SpliceWiz recommended filters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu">getDefaultFilters</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View a description of what these filters do:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">filters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Depth</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR MXE SE A3SS A5SS AFE ALE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">80.0</span> percent of all samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Event Depth: <span style="color: #BB0000;">20</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Participation</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">80.0</span> percent of all samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Coverage (Participation) Percentage: <span style="color: #BB0000;">70.0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In retained introns, participation refers to the proportion of the measured intron that is covered by at least 1 alignment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth below <span style="color: #AF00FF;">5</span> are ignored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Participation</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">SE A5SS A3SS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">80.0</span> percent of all samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Coverage (Participation) Percentage: <span style="color: #BB0000;">40.0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In splice events, participation refers to the proportion of junction reads that belong to either the included or excluded isoforms of the given event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth below <span style="color: #AF00FF;">20</span> are ignored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Consistency</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">MXE SE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">80.0</span> percent of all samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sub-event minimum proportion: <span style="color: #BB0000;">0.2</span> of total isoform splice count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In retained introns, sub-events refer to 5'- and 3'-exon-intron spanning alignments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In mutually exclusive exons and skipped exons, sub-events refer to the upstream and downstream splice alignments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth below <span style="color: #AF00FF;">20</span> are ignored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Annotation	</span>Type: <span style="color: #AF00FF;">Terminus</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR MXE SE A3SS A5SS AFE ALE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For alternative first / last exons, events overlapping with non-first/last introns are removed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Annotation	</span>Type: <span style="color: #AF00FF;">ExclusiveMXE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR MXE SE A3SS A5SS AFE ALE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MXE events with overlapping casette exons are removed</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filter the NxtSE using the first default filter ("Depth")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">se.depthfilter</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="fu">runFilter</span><span class="op">(</span><span class="va">se</span>, <span class="va">filters</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Depth filter</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filter the NxtSE using all four default filters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">se.defaultFiltered</span> <span class="op">&lt;-</span> <span class="va">se</span><span class="op">[</span><span class="fu">applyFilters</span><span class="op">(</span><span class="va">se</span>, <span class="fu">getDefaultFilters</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Depth filter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Participation filter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Participation filter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Consistency filter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Terminus filter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running ExclusiveMXE filter</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alex Chit Hei Wong.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

