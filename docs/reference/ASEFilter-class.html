<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SpliceWiz filters to remove low-confidence alternative splicing and intron
retention events — ASEFilter-class • SpliceWiz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SpliceWiz filters to remove low-confidence alternative splicing and intron
retention events — ASEFilter-class"><meta property="og:description" content="SpliceWiz implements a number of novel filters designed to exclude
alternative splicing events (ASEs) that yield low-confidence estimates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpliceWiz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SW_Cookbook.html">SpliceWiz: the cookbook</a>
    </li>
    <li>
      <a href="../articles/SW_QuickStart.html">SpliceWiz: Quick Start</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexchwong/SpliceWiz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SpliceWiz filters to remove low-confidence alternative splicing and intron
retention events</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexchwong/SpliceWiz/blob/HEAD/R/AllClasses.R" class="external-link"><code>R/AllClasses.R</code></a>, <a href="https://github.com/alexchwong/SpliceWiz/blob/HEAD/R/ASEFilter-methods.R" class="external-link"><code>R/ASEFilter-methods.R</code></a></small>
    <div class="hidden name"><code>ASEFilter-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>SpliceWiz implements a number of novel filters designed to exclude
alternative splicing events (ASEs) that yield low-confidence estimates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ASEFilter</span><span class="op">(</span></span>
<span>  filterClass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Data"</span>, <span class="st">"Annotation"</span><span class="op">)</span>,</span>
<span>  filterType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depth"</span>, <span class="st">"Participation"</span>, <span class="st">"Consistency"</span>, <span class="st">"Modality"</span>, <span class="st">"Protein_Coding"</span>,</span>
<span>    <span class="st">"NMD"</span>, <span class="st">"TSL"</span>, <span class="st">"Terminus"</span>, <span class="st">"ExclusiveMXE"</span><span class="op">)</span>,</span>
<span>  pcTRUE <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  minimum <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  maximum <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  minDepth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">""</span>,</span>
<span>  minCond <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  EventTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IR"</span>, <span class="st">"MXE"</span>, <span class="st">"SE"</span>, <span class="st">"A3SS"</span>, <span class="st">"A5SS"</span>, <span class="st">"AFE"</span>, <span class="st">"ALE"</span>, <span class="st">"RI"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>filterClass</dt>
<dd><p>Must be either <code>"Data"</code> or <code>"Annotation"</code>. See details</p></dd>


<dt>filterType</dt>
<dd><p>Must be a valid <code>"Data"</code> or <code>"Annotation"</code> filter. See
details</p></dd>


<dt>pcTRUE</dt>
<dd><p>If conditions are set, what percentage of all samples in each
of the condition must satisfy the filter for the event to pass the
filter check. Must be between 0 and 100 (default 100)</p></dd>


<dt>minimum</dt>
<dd><p>Filter-dependent argument. See details</p></dd>


<dt>maximum</dt>
<dd><p>Filter-dependent argument. See details</p></dd>


<dt>minDepth</dt>
<dd><p>Filter-dependent argument. See details</p></dd>


<dt>condition</dt>
<dd><p>(default "") If set, must match the name of an experimental
condition in the NxtSE object to be filtered,
i.e. a column name in <code>colData(se)</code>. Leave blank to disable filtering
by condition</p></dd>


<dt>minCond</dt>
<dd><p>(default -1) If condition is set, how many minimum number of
conditions must pass the filter criteria. For example,
if condition = "Batch", and batches are "A", "B", or "C", setting
<code>minCond = 2</code> with <code>pcTRUE = 100</code> means that all samples belonging to
two of the three types of <code>Batch</code> must pass the filter criteria.
Setting <code>-1</code> means all elements of <code>condition</code> must
pass criteria. Set to <code>-1</code> when the number of elements in the experimental
condition is unknown. Ignored if <code>condition</code> is left blank.</p></dd>


<dt>EventTypes</dt>
<dd><p>What types of events are considered for filtering. Must be
one or more of <code>c("IR", "MXE", "SE", "A3SS", "A5SS", "AFE", "ALE", "RI")</code>.
Events not specified in <code>EventTypes</code> are not filtered (i.e. they will pass
the filter without checks)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An ASEFilter object with the specified parameters</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Annotation Filters</strong></p><ul><li><p><strong>Modality</strong>: Filters for specific modalities of ASEs. All events
belonging to the specified <code>EventTypes</code> are removed.
No additional parameters required.</p></li>
<li><p><strong>Protein_Coding</strong>: Filters for alternative splicing or IR events
involving protein-coding transcripts.
No additional parameters required.</p></li>
<li><p><strong>NMD</strong>: Filters for events in which one isoform is a
predicted NMD substrate.</p></li>
<li><p><strong>TSL</strong>: filters for events in which both
isoforms have a TSL level below or equal to <code>minimum</code></p></li>
<li><p><strong>Terminus</strong>:
In alternate first exons, the splice junction must
not be shared with another transcript for which it is not its first
intron. For alternative last exons, the splice junction must not be
shared with another transcript for which it is not its last intron</p></li>
<li><p><strong>ExclusiveMXE</strong>:
For MXE events, the two alternate
casette exons must not overlap in their genomic regions</p></li>
</ul><p><strong>Data Filters</strong></p><ul><li><p><strong>Depth</strong>: Filters IR or alternative splicing events of transcripts
that are "expressed" with adequate <code>Depth</code> as calculated by the
sum of all splicing and IR reads spanning the event. Events with
<code>Depth</code> below <code>minimum</code> are filtered out</p></li>
<li><p><strong>Participation</strong>: Participation means different things to IR
and alternative splicing.<br><br>
For <strong>IR</strong>, Participation refers to the percentage of the measured intron
covered with reads. Only introns of samples with a depth of intron
coverage above
<code>minDepth</code> are assessed, with introns with coverage percentage
below <code>minimum</code> are filtered out.<br><br>
For <strong>Alternative Splicing</strong>, Participation refers to the percentage of
all splicing events observed across the genomic region that is
compatible with either the included or excluded event. This prevents
SpliceWiz from doing differential analysis between two minor isoforms.
Instead of IntronDepth, in AS events SpliceWiz considers events where
the spliced reads from both exonic regions exceed <code>minDepth</code>.
Then, events with a splicing coverage below <code>minimum</code>
are excluded. <br><br>
We recommend testing IR events for &gt; 70% coverage and AS
events for &gt; 40% coverage as given in the default filters which can be
accessed using <a href="Run_SpliceWiz_Filters.html">getDefaultFilters</a><br><br></p></li>
<li><p><strong>Consistency</strong>: Skipped exons (SE) and mutually exclusive exons
(MXE) comprise reads aligned to two contiguous splice junctions.
Most algorithms take the average counts from both junctions. This
will inadvertently include transcripts that share one but not both
splice events. To check that this is not happening, we require both
splice junctions to have comparable counts.
This filter checks whether reads from each splice junction comprises
a reasonable proportion of the sum of these reads.<br><br>
Events are excluded if either of the upstream or downstream
event is lower than total splicing events by a log-2 magnitude
above <code>maximum</code>. For example, if
<code>maximum = 2</code>, we require both upstream and downstream
events to represent at least 1/(2^2) = 1/4 of the sum of upstream
and downstream event. If <code>maximum = 3</code>, then each junction must be at
least 1/8 of total, etc.
This is considered for each isoform of each event, as long as the
total counts belonging to the considered isoform is above
<code>minDepth</code>.<br><br>
IR-events are also checked. For IR events, the upstream and downstream
exon-intron spanning reads must comprise a reasonable proportion of total
exon-intron spanning reads.</p></li>
</ul><p>We highly recommend using the default filters, which can be acquired
using <a href="Run_SpliceWiz_Filters.html">getDefaultFilters</a></p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>ASEFilter</code>: Constructs a ASEFilter object</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="Run_SpliceWiz_Filters.html">Run_SpliceWiz_Filters</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a ASEFilter that filters for protein-coding ASE</span></span></span>
<span class="r-in"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">ASEFilter</span><span class="op">(</span>filterClass <span class="op">=</span> <span class="st">"Annotation"</span>, filterType <span class="op">=</span> <span class="st">"Protein_Coding"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a ASEFilter that filters for Depth &gt;= 20 in IR events</span></span></span>
<span class="r-in"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">ASEFilter</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filterClass <span class="op">=</span> <span class="st">"Data"</span>, filterType <span class="op">=</span> <span class="st">"Depth"</span>,</span></span>
<span class="r-in"><span>    minimum <span class="op">=</span> <span class="fl">20</span>, EventTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IR"</span>, <span class="st">"RI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a ASEFilter that filters for Participation &gt; 60% in splice events</span></span></span>
<span class="r-in"><span><span class="co"># that must be satisfied in at least 2 categories of condition "Genotype"</span></span></span>
<span class="r-in"><span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">ASEFilter</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filterClass <span class="op">=</span> <span class="st">"Data"</span>, filterType <span class="op">=</span> <span class="st">"Participation"</span>,</span></span>
<span class="r-in"><span>    minimum <span class="op">=</span> <span class="fl">60</span>, EventTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MXE"</span>, <span class="st">"SE"</span>, <span class="st">"AFE"</span>, <span class="st">"ALE"</span>, <span class="st">"A3SS"</span>, <span class="st">"A5SS"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    condition <span class="op">=</span> <span class="st">"Genotype"</span>, minCond <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a ASEFilter that filters for Depth &gt; 10 in all events</span></span></span>
<span class="r-in"><span><span class="co"># that must be satisfied in at least 50% of each gender</span></span></span>
<span class="r-in"><span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu">ASEFilter</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filterClass <span class="op">=</span> <span class="st">"Data"</span>, filterType <span class="op">=</span> <span class="st">"Depth"</span>,</span></span>
<span class="r-in"><span>    minimum <span class="op">=</span> <span class="fl">10</span>, condition <span class="op">=</span> <span class="st">"gender"</span>, pcTRUE <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a description of what these filters do:</span></span></span>
<span class="r-in"><span><span class="va">f1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Annotation	</span>Type: <span style="color: #AF00FF;">Protein_Coding</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR MXE SE A3SS A5SS AFE ALE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Events of which neither isoform encodes protein are removed</span>
<span class="r-in"><span><span class="va">f2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Depth</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">100.0</span> percent of all samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Event Depth: <span style="color: #BB0000;">20</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-in"><span><span class="va">f3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Participation</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">MXE SE AFE ALE A3SS A5SS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">100.0</span> percent of <span style="color: #00BB00;">2</span> categories of <span style="color: #AF00FF;">Genotype</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Coverage (Participation) Percentage: <span style="color: #BB0000;">60.0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In splice events, participation refers to the proportion of junction reads that belong to either the included or excluded isoforms of the given event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth below <span style="color: #AF00FF;">5</span> are ignored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-in"><span><span class="va">f4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ASEFilter Class: <span style="color: #BB0000;">Data	</span>Type: <span style="color: #AF00FF;">Depth</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EventTypes: <span style="color: #00BB00;">IR MXE SE A3SS A5SS AFE ALE RI</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filter must be passed in at least <span style="color: #AF00FF;">50.0</span> percent of all categories of <span style="color: #AF00FF;">gender</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Event Depth: <span style="color: #BB0000;">10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event Depth refers to number of aligned splice reads plus effective depth of their introns</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alex Chit Hei Wong.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

