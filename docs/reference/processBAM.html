<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Runs the OpenMP/C++ based SpliceWiz algorithm — processBAM • SpliceWiz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Runs the OpenMP/C++ based SpliceWiz algorithm — processBAM"><meta property="og:description" content='These function calls the SpliceWiz C++ routine on one or more BAM files.
 The routine is an improved version over the original IRFinder, with
OpenMP-based multi-threading and the production of compact "COV" files to
record alignment coverage. A SpliceWiz reference built using
Build-Reference-methods is required.
After processBAM() is run, users should call
collateData to collate individual outputs into an experiment / dataset.

BAM2COV creates COV files from BAM files without running processBAM().
 See details for performance info.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpliceWiz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SW_Cookbook.html">SpliceWiz: the cookbook</a>
    </li>
    <li>
      <a href="../articles/SW_QuickStart.html">SpliceWiz: Quick Start</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexchwong/SpliceWiz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs the OpenMP/C++ based SpliceWiz algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexchwong/SpliceWiz/blob/HEAD/R/ProcessBAM.R" class="external-link"><code>R/ProcessBAM.R</code></a></small>
    <div class="hidden name"><code>processBAM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These function calls the SpliceWiz C++ routine on one or more BAM files.
<br><br> The routine is an improved version over the original IRFinder, with
OpenMP-based multi-threading and the production of compact "COV" files to
record alignment coverage. A SpliceWiz reference built using
<a href="Build-Reference-methods.html">Build-Reference-methods</a> is required.<br><br>
After <code>processBAM()</code> is run, users should call
<a href="collateData.html">collateData</a> to collate individual outputs into an experiment / dataset.
<br><br>
BAM2COV creates COV files from BAM files without running <code>processBAM()</code>.
<br><br> See details for performance info.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BAM2COV</span><span class="op">(</span></span>
<span>  bamfiles <span class="op">=</span> <span class="st">"./Unsorted.bam"</span>,</span>
<span>  sample_names <span class="op">=</span> <span class="st">"sample1"</span>,</span>
<span>  output_path <span class="op">=</span> <span class="st">"./cov_folder"</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  useOpenMP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  multiRead <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">processBAM</span><span class="op">(</span></span>
<span>  bamfiles <span class="op">=</span> <span class="st">"./Unsorted.bam"</span>,</span>
<span>  sample_names <span class="op">=</span> <span class="st">"sample1"</span>,</span>
<span>  reference_path <span class="op">=</span> <span class="st">"./Reference"</span>,</span>
<span>  output_path <span class="op">=</span> <span class="st">"./SpliceWiz_Output"</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  useOpenMP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  run_featureCounts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  multiRead <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bamfiles</dt>
<dd><p>A vector containing file paths of 1 or more BAM files</p></dd>


<dt>sample_names</dt>
<dd><p>The sample names of the given BAM files. Must
be a vector of the same length as <code>bamfiles</code></p></dd>


<dt>output_path</dt>
<dd><p>The output directory of this function</p></dd>


<dt>n_threads</dt>
<dd><p>(default <code>1</code>) The number of threads to use. See details.</p></dd>


<dt>useOpenMP</dt>
<dd><p>(default <code>TRUE</code>) Whether to use OpenMP.
If set to <code>FALSE</code>, BiocParallel will be used if <code>n_threads</code> is set</p></dd>


<dt>overwrite</dt>
<dd><p>(default <code>FALSE</code>) If output files already exist,
will not attempt to re-run. If <code>run_featureCounts</code> is <code>TRUE</code>, will not
overwrite gene counts of previous run unless <code>overwrite</code> is <code>TRUE</code>.</p></dd>


<dt>verbose</dt>
<dd><p>(default <code>FALSE</code>) Set to <code>TRUE</code> to allow <code>processBAM()</code> to
output progress bars and messages</p></dd>


<dt>multiRead</dt>
<dd><p>(default <code>FALSE</code>) Whether to use multiple threads to read
files. Set to <code>TRUE</code> to use multiple threads (improves performance if
files are already cached into memory.</p></dd>


<dt>reference_path</dt>
<dd><p>The directory containing the SpliceWiz reference</p></dd>


<dt>run_featureCounts</dt>
<dd><p>(default <code>FALSE</code>) Whether this function will run
Rsubread::featureCounts on the BAM files after counting spliced reads.
If so, the output will be
saved to <code>"main.FC.Rds</code> in the <code>output_path</code> directory as a list object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>processBAM()</code> output will be saved to <code>output_path</code>. Output files
will be named using the given sample names.</p><ul><li><p>sample.txt.gz: The main output file containing the quantitation
of IR and splice junctions, as well as QC information<br><br></p></li>
<li><p>sample.cov: Contains coverage information in compressed binary. See
<a href="Coverage.html">getCoverage</a></p></li>
<li><p>main.FC.Rds: A single file containing gene counts for the whole dataset
(only if <code>run_featureCounts == TRUE</code>)</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Typical run-times for a 100-million paired-end alignment BAM file takes 10
minutes using a single core. Using 8 threads, the runtime is approximately
2-5 minutes, depending on your system's file input / output speeds.
Approximately 10 Gb of RAM is used when OpenMP is used. If OpenMP
is not used (see below), this memory usage is multiplied across the number
of processor threads (i.e. 40 Gb if <code>n_threads = 4</code>).</p>
<p>OpenMP is natively available to Linux / Windows compilers, and OpenMP will
be used if <code>useOpenMP</code> is set to <code>TRUE</code>, using multiple threads to process
each BAM file. On Macs, if OpenMP is not available at compilation,
BiocParallel will be used, processing BAM files simultaneously,
with one BAM file per thread.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>BAM2COV</code>: Converts BAM files to COV files without running
<code>processBAM()</code></p></li>
<li><p><code>processBAM</code>: Processes BAM files. Requires a
SpliceWiz reference generated by buildRef()</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="Build-Reference-methods.html">Build-Reference-methods</a> <a href="collateData.html">collateData</a> <a href="isCOV.html">isCOV</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run BAM2COV, which only produces COV files but does not run `processBAM()`:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bams</span> <span class="op">&lt;-</span> <span class="fu"><a href="example-SpliceWiz-data.html">SpliceWiz_example_bams</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">BAM2COV</span><span class="op">(</span><span class="va">bams</span><span class="op">$</span><span class="va">path</span>, <span class="va">bams</span><span class="op">$</span><span class="va">sample</span>,</span></span>
<span class="r-in"><span>  output_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"SpliceWiz_Output"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_threads <span class="op">=</span> <span class="fl">2</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Nov 15 16:17:13 Running BAM2COV</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Nov 15 16:17:13 Using MulticoreParam 2 threads</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run processBAM(), which produces:</span></span></span>
<span class="r-in"><span><span class="co"># - text output of intron coverage and spliced read counts</span></span></span>
<span class="r-in"><span><span class="co"># - COV files which record read coverages</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">example_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Reference"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Build-Reference-methods.html">buildRef</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    reference_path <span class="op">=</span> <span class="va">example_ref</span>,</span></span>
<span class="r-in"><span>    fasta <span class="op">=</span> <span class="fu">chrZ_genome</span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gtf <span class="op">=</span> <span class="fu">chrZ_gtf</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Nov 15 16:17:15 SpliceWiz reference already exists in given directory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bams</span> <span class="op">&lt;-</span> <span class="fu"><a href="example-SpliceWiz-data.html">SpliceWiz_example_bams</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">processBAM</span><span class="op">(</span><span class="va">bams</span><span class="op">$</span><span class="va">path</span>, <span class="va">bams</span><span class="op">$</span><span class="va">sample</span>,</span></span>
<span class="r-in"><span>  reference_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Reference"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  output_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"SpliceWiz_Output"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_threads <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Nov 15 16:17:15 processBAM has already been run on given BAM files</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alex Chit Hei Wong.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

