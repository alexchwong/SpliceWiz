<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct data of percent-spliced-in (PSI) matrices and group-average PSIs — make_plot_data • SpliceWiz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct data of percent-spliced-in (PSI) matrices and group-average PSIs — make_plot_data"><meta property="og:description" content='makeMatrix() constructs a matrix of PSI values of the given alternative
splicing events (ASEs).
makeMeanPSI() constructs a table of "average" PSI values, with samples
grouped by a number of given conditions (e.g. "group A" and "group B") of a
given condition category (e.g. condition "treatment").
See details below.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpliceWiz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SW_Cookbook.html">SpliceWiz: the cookbook</a>
    </li>
    <li>
      <a href="../articles/SW_QuickStart.html">SpliceWiz: Quick Start</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexchwong/SpliceWiz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct data of percent-spliced-in (PSI) matrices and group-average PSIs</h1>
    <small class="dont-index">Source: <a href="https://github.com/alexchwong/SpliceWiz/blob/HEAD/R/make_plot_data.R" class="external-link"><code>R/make_plot_data.R</code></a></small>
    <div class="hidden name"><code>make_plot_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>makeMatrix()</code> constructs a matrix of PSI values of the given alternative
splicing events (ASEs).<br><br><code>makeMeanPSI()</code> constructs a table of "average" PSI values, with samples
grouped by a number of given conditions (e.g. "group A" and "group B") of a
given condition category (e.g. condition "treatment").
See details below.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeMatrix</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">event_list</span>,</span>
<span>  sample_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PSI"</span>, <span class="st">"logit"</span>, <span class="st">"Z-score"</span><span class="op">)</span>,</span>
<span>  depth_threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  logit_max <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  na.percent.max <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">makeMeanPSI</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  event_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>  <span class="va">condition</span>,</span>
<span>  <span class="va">conditionList</span>,</span>
<span>  depth_threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  logit_max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>se</dt>
<dd><p>(Required) A <a href="NxtSE-class.html">NxtSE</a> object generated by <a href="makeSE.html">makeSE</a></p></dd>


<dt>event_list</dt>
<dd><p>A character vector containing the names of ASE events
(as given by the <code>EventName</code> column of differential ASE results table
generated by one of the <a href="ASE-methods.html">ASE-methods</a>, or
the rownames of the <a href="NxtSE-class.html">NxtSE</a> object)</p></dd>


<dt>sample_list</dt>
<dd><p>(default = <code>colnames(se)</code>) In <code>makeMatrix()</code>, a list of
sample names in the given experiment to be included in the returned matrix</p></dd>


<dt>method</dt>
<dd><p>In <code>makeMatrix()</code>, rhe values to be returned
(default = "PSI"). It can
alternately be "logit" which returns logit-transformed PSI values, or
"Z-score" which returns Z-score-transformed PSI values</p></dd>


<dt>depth_threshold</dt>
<dd><p>(default = 10) Samples with the number of reads
supporting either included or excluded isoforms below this values are
excluded</p></dd>


<dt>logit_max</dt>
<dd><p>PSI values close to 0 or 1 are rounded up/down
to <code>plogis(-logit_max)</code> and <code>plogis(logit_max)</code>, respectively. See details.</p></dd>


<dt>na.percent.max</dt>
<dd><p>(default = 0.1) The maximum proportion of values in
the given dataset that were transformed to <code>NA</code> because of low splicing
depth. ASE events where there are a higher proportion (default 10%) <code>NA</code>
values will be excluded from the final matrix. Most heatmap
functions will spring an error if there are too many NA values in any
given row. This option caps the number of NA values to avoid returning
this error.</p></dd>


<dt>condition</dt>
<dd><p>The name of the column containing the condition values in
<code>colData(se)</code></p></dd>


<dt>conditionList</dt>
<dd><p>A list (or vector) of condition values of which to
calculate mean PSIs</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>For <code>makeMatrix</code>: A matrix of PSI (or alternate) values, with
columns as samples and rows as ASE events.</p>


<p>For <code>makeMeanPSI</code>: A 3 column data frame, with the first column containing
<code>event_list</code> list of ASE events, and the last 2 columns containing the
average PSI values of the nominator and denominator conditions.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that this function takes the geometric mean of PSI, by first converting
all values to logit(PSI), taking the average logit(PSI) values of each
condition, and then converting back to PSI using inverse logit.</p>
<p>Samples with low splicing coverage (either due to insufficient sequencing
depth or low gene expression) are excluded from calculation of mean PSIs.
The threshold can be set using <code>depth_threshold</code>. Excluding these samples is
appropriate because the uncertainty of PSI is high when the total included /
excluded count is low. Note that events where all samples in a condition is
excluded will return a value of <code>NaN</code>.</p>
<p>Using logit-transformed PSI values is appropriate because PSI values are
bound to the (0,1) interval, and are often thought to be beta-distributed.
The link function often used with beta-distributed models is the logit
function, which is defined as <code>logit(x) = function(x) log(x / (1 - x))</code>,
and is equivalent to <a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">stats::qlogis</a>. Its inverse is equivalent to
<a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">stats::plogis</a>.</p>
<p>Users wishing to calculate arithmetic means of PSI are advised to use
makeMatrix, followed by <a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a> on subsetted sample columns.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>makeMatrix</code>: constructs a matrix of PSI values of the given
alternative splicing events (ASEs)</p></li>
<li><p><code>makeMeanPSI</code>: constructs a table of "average" PSI values</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="example-SpliceWiz-data.html">SpliceWiz_example_NxtSE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">event_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">EventName</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">makeMatrix</span><span class="op">(</span><span class="va">se</span>, <span class="va">event_list</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">diag_values</span> <span class="op">&lt;-</span> <span class="fu">makeMeanPSI</span><span class="op">(</span><span class="va">se</span>, <span class="va">event_list</span>,</span></span>
<span class="r-in"><span>  condition <span class="op">=</span> <span class="st">"treatment"</span>, </span></span>
<span class="r-in"><span>  conditionList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alex Chit Hei Wong.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

